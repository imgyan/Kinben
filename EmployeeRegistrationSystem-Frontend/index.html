<!DOCTYPE html>
<html>
<head>
    <title>Employee Management System</title>
    <style>
        /* Add your CSS styles here */
        body {
  font-family: Arial, sans-serif;
  padding: 20px;
}

h1 {
  text-align: center;
}

h2 {
  margin-top: 30px;
}

form {
  margin-bottom: 20px;
}

label {
  display: block;
  margin-top: 10px;
}

input[type="text"],
input[type="number"],
input[type="email"],
textarea,
select {
  width: 100%;
  padding: 8px;
  border: 1px solid #ccc;
  border-radius: 4px;
}

button {
  margin-top: 10px;
  padding: 8px 16px;
  background-color: #4CAF50;
  color: #fff;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

button:hover {
  background-color: #45a049;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
}

th, td {
  padding: 8px;
  text-align: left;
  border-bottom: 1px solid #ddd;
}

th {
  background-color: #4CAF50;
  color: #fff;
}

tr:hover {
  background-color: #f5f5f5;
}

    </style>
</head>
<body>
    <h1>Employee Management System</h1>
    
    <h2>New Employee Registration</h2>
    <form id="registrationForm">
        <label for="name">Name:</label>
        <input type="text" id="name" required>
        
        <label for="contact">Contact Number:</label>
        <input type="number" id="contact" required>
        
        <label for="email">Email:</label>
        <input type="email" id="email" required>
        
        <label for="address">Address:</label>
        <textarea id="address" required></textarea>
        
        <label for="education">Education:</label>
        <select id="education" required>
            <option value="MCA">MCA</option>
            <option value="BTech">B. Tech</option>
            <option value="BSc_CS">B. Sc. (cs)</option>
            <option value="MTech">M. Tech</option>
        </select>
        
        <label for="experience">Total Years of Experience:</label>
        <input type="number" id="experience" required>
        
        <button type="submit"  onclick="registerEmployee()">Register</button>
        
    </form>
    
    <h2 onLoad="f1();">Employee List</h2>
    <table id="employeeTable">
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Contact Number</th>
                <th>Email</th>
                <th>Address</th>
                <th>Education</th>
                <th>Experience</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="employeeTableBody"></tbody>
    </table>


    <script>

          // Function to register a new employee
function registerEmployee(){
  
  const form = document.getElementById('registrationForm');
  const employeeName = form.elements['name'].value;
  const phoneNumber = form.elements['contact'].value;
  const email = form.elements['email'].value;
  const address = form.elements['address'].value;
  const education = form.elements['education'].value;
  const totalYearOfExperience = form.elements['experience'].value;


fetch("http://localhost:8888/employee", {

    method: "POST",
    headers: {
        "content-type": "application/json"
    },
    body: JSON.stringify({
       
        "employeeName": employeeName,
    "phoneNumber" : phoneNumber,
    "email": email,
    "address": address,
    "education": education,
    "totalYearOfExperience" : totalYearOfExperience
    })
}).then(response => {
    if(response.status == 201 | response.status == 200){
        response.json().then(data => {
            alert("Employee sucessfully registered with Roll: "+data.employeeId)
        });
    }else{
      console.log("qwdfghjkl;")
        response.json().then(data => alert(data.message));

    }
})


}




      // Function to fetch and display all employees

 window.onload =f1();
function f1() {
  
  fetch('http://localhost:8888/getallemployee')
    .then(response => response.json())
    .then(data => {
      const employeeTableBody = document.getElementById('employeeTableBody');
      employeeTableBody.innerHTML = '';

      data.forEach(employee => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${employee.employeeId}</td>
          <td>${employee.employeeName}</td>
          <td>${employee.phoneNumber}</td>
          <td>${employee.email}</td>
          <td>${employee.address}</td>
          <td>${employee.education}</td>
          <td>${employee.totalYearOfExperience}</td>
          <td>
            <button onclick="editEmployee(${employee.employeeId})">Edit</button>
            <button onclick="deleteEmployee(${employee.employeeId})">Delete</button>
          </td>
        `;
        employeeTableBody.appendChild(row);
        
      });
      
    })
    .catch(error => console.log(error));
}


// Function to delete an employee
function deleteEmployee(employeeId) {
  if (confirm('Are you sure you want to delete this employee?')) {
    fetch(`http://localhost:8888/employee/${employeeId}`, {
      method: 'DELETE'
    })
      .then(response => response.json())
      .then(data => {
        console.log('Employee deleted:', data);
        f1();
      })
      .catch(error => console.log(error));
  }
}




// Function to update an employee
function updateEmployee(employeeId) {
  console.log("Updated")
  const form = document.getElementById('registrationForm');
  const employeeName = form.elements['name'].value;
  const phoneNumber = form.elements['contact'].value;
  const email = form.elements['email'].value;
  const address = form.elements['address'].value;
  const education = form.elements['education'].value;
  const totalYearOfExperience = form.elements['experience'].value;

  fetch("http://localhost:8888/updateemployee", {
    method: 'PATCH',
  
  headers: {
        "content-type": "application/json"
    },
    body: JSON.stringify({
       "employeeId" : employeeId,
        "employeeName": employeeName,
    "phoneNumber" : phoneNumber,
    "email": email,
    "address": address,
    "education": education,
    "totalYearOfExperience" : totalYearOfExperience
    })
}).then(response => {

    if(response.status == 201 | response.status == 200){
        response.json().then(data => {
            alert("Employee updated successfully with Roll: "+data.employeeId)
            
          
             f1();
        });
    }else{
      console.log("qwdfghjkl;")
        response.json().then(data => alert(data.message));

    }
})
}

// Function to populate the form with employee data for editing
function editEmployee(employeeId) {
  fetch(`http://localhost:8888/employee/${employeeId}`)
    .then(response => response.json())
    .then(data => {
      const form = document.getElementById('registrationForm');
      form.elements['name'].value = data.employeeName;
      form.elements['contact'].value = data.phoneNumber;
      form.elements['email'].value = data.email;
      form.elements['address'].value = data.address;
      form.elements['education'].value = data.education;
      form.elements['experience'].value = data.totalYearOfExperience;

      const registerButton = document.querySelector('#registrationForm button[type="submit"]');
      registerButton.textContent = 'Update';
      registerButton.setAttribute('onclick', `updateEmployee(${employeeId})`);
    })
    .catch(error => console.log(error));
}







    </script>
    
   
   
    
</body>
</html>
